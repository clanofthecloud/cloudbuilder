<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>CloudBuilder: CloudBuilder::CStoreManager Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="CloudBuilder_logo_128x128.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">CloudBuilder
   &#160;<span id="projectnumber">3.0.0</span>
   </div>
   <div id="projectbrief">Making social games is easy !</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_cloud_builder.html">CloudBuilder</a></li><li class="navelem"><a class="el" href="struct_cloud_builder_1_1_c_store_manager.html">CStoreManager</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="struct_cloud_builder_1_1_c_store_manager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CloudBuilder::CStoreManager Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_c_store_manager_8h_source.html">CStoreManager.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab75d21217778700e7065f93ba8e6ff9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_cloud_builder_1_1_c_store_manager.html#ab75d21217778700e7065f93ba8e6ff9b">FetchProductInformation</a> (<a class="el" href="namespace_cloud_builder.html#aa9298038517f1c9498ac65a0fef1ff93">CResultHandler</a> *aHandler, const <a class="el" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html">CHJSON</a> *aConfiguration)</td></tr>
<tr class="separator:ab75d21217778700e7065f93ba8e6ff9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1569f6dacb2c2b9ebcd0fccca42ed66b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_cloud_builder_1_1_c_store_manager.html#a1569f6dacb2c2b9ebcd0fccca42ed66b">GetPurchaseHistory</a> (<a class="el" href="namespace_cloud_builder.html#aa9298038517f1c9498ac65a0fef1ff93">CResultHandler</a> *aHandler, const <a class="el" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html">CHJSON</a> *aConfiguration)</td></tr>
<tr class="separator:a1569f6dacb2c2b9ebcd0fccca42ed66b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dd7d86f840551ae086330262a8aef77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_cloud_builder_1_1_c_store_manager.html#a3dd7d86f840551ae086330262a8aef77">LaunchPurchase</a> (<a class="el" href="namespace_cloud_builder.html#aa9298038517f1c9498ac65a0fef1ff93">CResultHandler</a> *aHandler, const <a class="el" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html">CHJSON</a> *aConfiguration)</td></tr>
<tr class="separator:a3dd7d86f840551ae086330262a8aef77"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a0d738a2a31a49811a61741e08c93fcca"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="struct_cloud_builder_1_1_c_store_manager.html">CStoreManager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_cloud_builder_1_1_c_store_manager.html#a0d738a2a31a49811a61741e08c93fcca">Instance</a> ()</td></tr>
<tr class="separator:a0d738a2a31a49811a61741e08c93fcca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a2ce455cdc1abc45f224b4ab4c4731762"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2ce455cdc1abc45f224b4ab4c4731762"></a>
struct&#160;</td><td class="memItemRight" valign="bottom"><b>singleton_holder&lt; CStoreManager &gt;</b></td></tr>
<tr class="separator:a2ce455cdc1abc45f224b4ab4c4731762"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2da8181f62b10ed8ed9d1c71e3d83d64"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2da8181f62b10ed8ed9d1c71e3d83d64"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>CClan::Terminate</b> ()</td></tr>
<tr class="separator:a2da8181f62b10ed8ed9d1c71e3d83d64"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="struct_cloud_builder_1_1_c_store_manager.html">CStoreManager</a> class allows to easily make in-app purchase on supported platforms. You basically unlock features by running on transaction once the CotC servers have successfully verified the financial transaction. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ab75d21217778700e7065f93ba8e6ff9b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CloudBuilder::CStoreManager::FetchProductInformation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespace_cloud_builder.html#aa9298038517f1c9498ac65a0fef1ff93">CResultHandler</a> *&#160;</td>
          <td class="paramname"><em>aHandler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html">CHJSON</a> *&#160;</td>
          <td class="paramname"><em>aConfiguration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fetches a "catalog" of products available for purchase as configured on the server. Note that this call returns the catalog as configured on the CotC server, which may not be exhaustive if additional products are configured on iTunes Connect but not reported to the CotC servers. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aHandler</td><td>result handler whenever the call finishes (it might also be synchronous) </td></tr>
    <tr><td class="paramname">aConfiguration</td><td>unused </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>if noErr, the json passed to the handler may contain:<ul>
<li>"products" (array of objects): information about the products, which may contain:<ul>
<li>"productId" (string): the ID of product as matching on iTunes Connect. This is the actual product that will be purchased. You set its price and such on Apple servers.</li>
<li>"price" (number): this entry is present if the product has been found on Apple servers. It contains the price in the local currency of the current user.</li>
<li>"currency" (string): if the product has a match on iTunes Connect, contains the local currency of the current user. </li>
</ul>
</li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="a1569f6dacb2c2b9ebcd0fccca42ed66b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CloudBuilder::CStoreManager::GetPurchaseHistory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespace_cloud_builder.html#aa9298038517f1c9498ac65a0fef1ff93">CResultHandler</a> *&#160;</td>
          <td class="paramname"><em>aHandler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html">CHJSON</a> *&#160;</td>
          <td class="paramname"><em>aConfiguration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fetches the list of transactions made by the logged in user. Only successful transactions show here. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aHandler</td><td>result handler whenever the call finishes (it might also be synchronous) </td></tr>
    <tr><td class="paramname">aConfiguration</td><td>currently unused </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>if noErr, the json passed to the handler may contain:<ul>
<li>"transactions" (array of objects): information about the transactions, which may contain:<ul>
<li>"store" (string): the type of Store on which the purchase has been made.</li>
<li>"productId" (string): the ID of the product paid on the in-app store.</li>
<li>"dateTime": ISO 8601 time of purchase.</li>
<li>"price" (number): price paid (the price might have been changed since then on iTunes Connect; any such change does not reflect here).</li>
<li>"currency" (string): currency of the price paid.</li>
<li>"storeTransactionId" (string): the ID of transaction on the original store. You might want to use it for customer service. Depends on the store type. </li>
</ul>
</li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="a0d738a2a31a49811a61741e08c93fcca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="struct_cloud_builder_1_1_c_store_manager.html">CStoreManager</a>* CloudBuilder::CStoreManager::Instance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Use this method to obtain a reference to the <a class="el" href="struct_cloud_builder_1_1_c_store_manager.html">CStoreManager</a>. </p><dl class="section return"><dt>Returns</dt><dd>the one and only instance of this manager </dd></dl>

</div>
</div>
<a class="anchor" id="a3dd7d86f840551ae086330262a8aef77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CloudBuilder::CStoreManager::LaunchPurchase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespace_cloud_builder.html#aa9298038517f1c9498ac65a0fef1ff93">CResultHandler</a> *&#160;</td>
          <td class="paramname"><em>aHandler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html">CHJSON</a> *&#160;</td>
          <td class="paramname"><em>aConfiguration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Launches a purchase process for a given product. The purchase process is asynchronous, may take a lot of time and may not necessarily ever finish (i.e. the application may be killed before it actually finishes). That said, only one purchase process is running at at a time, and refusal to purchase the good will lead to a notification in the result handler as far as notified by the underlying store.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aHandler</td><td>result handler whenever the call finishes (it might also be synchronous) </td></tr>
    <tr><td class="paramname">aConfiguration</td><td>parameters on how and what to purchase. May contain:<ul>
<li>"productId" (string): the ID of product, that should either be hardcoded in your application or fetched from a previous call to <a class="el" href="struct_cloud_builder_1_1_c_store_manager.html#ab75d21217778700e7065f93ba8e6ff9b">FetchProductInformation</a>. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>if noErr, the json passed to the handler may contain:<ul>
<li>"validation" (object): status of purchase<ul>
<li>"ok" (number): 1 if the purchase has been done properly (should always be the case).</li>
<li>"repeated" (number): 1 if the purchase has been considered as a duplicate. This means that the order was already processed previously and the reward associated with the purchase was not given. This does not necessarily means that there was a piracy attempt or that the reward was never given; it might simply be that the order was validated on the server and the transaction executed, but the client did not get the answer at the time, thus trying again.</li>
<li><p class="startli">"purchase" (optional object): information about the purchase made. Only supplied in case of successful purchase. If the purchase was already validated before (repeated transaction), this field is only available if the purchase was made by the same user as now. It is omitted in other cases.</p>
<p class="startli">You might want to use it for customer service. Depends on the store type and might not be supplied in case of a repeated transaction that was made by another user. </p>
</li>
</ul>
</li>
</ul>
</dd></dl>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>Headers/<a class="el" href="_c_store_manager_8h_source.html">CStoreManager.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 28 2015 13:02:13 for CloudBuilder by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
