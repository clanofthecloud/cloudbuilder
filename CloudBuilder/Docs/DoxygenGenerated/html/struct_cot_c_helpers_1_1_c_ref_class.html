<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CloudBuilder C++ SDK: CotCHelpers::CRefClass Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xtralife-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CloudBuilder C++ SDK
   &#160;<span id="projectnumber">v3.0.0</span>
   </div>
   <div id="projectbrief">Making social games is easy !</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_cot_c_helpers.html">CotCHelpers</a></li><li class="navelem"><a class="el" href="struct_cot_c_helpers_1_1_c_ref_class.html">CRefClass</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="struct_cot_c_helpers_1_1_c_ref_class-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CotCHelpers::CRefClass Struct Reference<div class="ingroups"><a class="el" href="group__cotchelpers.html">Helper classes used to interact with our API.</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_cot_c_helpers_8h_source.html">CotCHelpers.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for CotCHelpers::CRefClass:</div>
<div class="dyncontent">
 <div class="center">
  <img src="struct_cot_c_helpers_1_1_c_ref_class.png" usemap="#CotCHelpers::CRefClass_map" alt=""/>
  <map id="CotCHelpers::CRefClass_map" name="CotCHelpers::CRefClass_map">
<area href="struct_cloud_builder_1_1_c_event_listener.html" alt="CloudBuilder::CEventListener" shape="rect" coords="0,56,212,80"/>
<area href="struct_cloud_builder_1_1_c_match_event_listener.html" alt="CloudBuilder::CMatchEventListener" shape="rect" coords="222,56,434,80"/>
<area href="class_cot_c_helpers_1_1_c_thread.html" alt="CotCHelpers::CThread" shape="rect" coords="444,56,656,80"/>
<area href="struct_cloud_builder_1_1_c_match.html" alt="CloudBuilder::CMatch" shape="rect" coords="0,112,212,136"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a32625f3ced4c58559f0410fe463b423b"><td class="memItemLeft" align="right" valign="top"><a id="a32625f3ced4c58559f0410fe463b423b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>Retain</b> ()</td></tr>
<tr class="separator:a32625f3ced4c58559f0410fe463b423b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac530e4d269f520c5a1eae383b58fd25b"><td class="memItemLeft" align="right" valign="top"><a id="ac530e4d269f520c5a1eae383b58fd25b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>Release</b> ()</td></tr>
<tr class="separator:ac530e4d269f520c5a1eae383b58fd25b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a003f118222fa25afa2bff0e0788233a1"><td class="memItemLeft" align="right" valign="top"><a id="a003f118222fa25afa2bff0e0788233a1"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CRefClass</b> (const <a class="el" href="struct_cot_c_helpers_1_1_c_ref_class.html">CRefClass</a> &amp;other)</td></tr>
<tr class="separator:a003f118222fa25afa2bff0e0788233a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c323b1a19712db51a33605c6516ee56"><td class="memItemLeft" align="right" valign="top"><a id="a8c323b1a19712db51a33605c6516ee56"></a>
<a class="el" href="struct_cot_c_helpers_1_1_c_ref_class.html">CRefClass</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="struct_cot_c_helpers_1_1_c_ref_class.html">CRefClass</a> &amp;other)</td></tr>
<tr class="separator:a8c323b1a19712db51a33605c6516ee56"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a5b1744dd68f5903bed54ff78e3074ca3"><td class="memTemplParams" colspan="2"><a id="a5b1744dd68f5903bed54ff78e3074ca3"></a>
template&lt;class T &gt; </td></tr>
<tr class="memitem:a5b1744dd68f5903bed54ff78e3074ca3"><td class="memTemplItemLeft" align="right" valign="top">static T *&#160;</td><td class="memTemplItemRight" valign="bottom"><b>Retain</b> (T *t)</td></tr>
<tr class="separator:a5b1744dd68f5903bed54ff78e3074ca3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefa98cdbd4ccbd98209a59beb4d28a18"><td class="memTemplParams" colspan="2"><a id="aefa98cdbd4ccbd98209a59beb4d28a18"></a>
template&lt;class T &gt; </td></tr>
<tr class="memitem:aefa98cdbd4ccbd98209a59beb4d28a18"><td class="memTemplItemLeft" align="right" valign="top">static T *&#160;</td><td class="memTemplItemRight" valign="bottom"><b>Release</b> (T *t)</td></tr>
<tr class="separator:aefa98cdbd4ccbd98209a59beb4d28a18"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a49e0e19635afd713b4afc6661a700c7f"><td class="memItemLeft" align="right" valign="top"><a id="a49e0e19635afd713b4afc6661a700c7f"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><b>__ref_count</b></td></tr>
<tr class="separator:a49e0e19635afd713b4afc6661a700c7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Base class indicating a reference-counted object. The rules are as follow:</p><ul>
<li>When creating an object (with 'new' or from a factory method, stating that the return value is owned by you), you need to call Release() when you are done.</li>
<li>In other cases, the object is just passed to you as a reference and will be released by its owner. If you would like to keep the object for longer than the scope of the current method (typically, when assigning to a class member), call Retain() on it and then Release() when you don't need it anymore.</li>
</ul>
<p>Once all the owners have called Release() (the original one which created it as well as all those which called Retain()) the object can be destroyed.</p>
<p>Technically, the object starts with a reference count of 1, calling Release() decrements the count, calling Retain() increments it. When reaching zero, the object is destroyed.</p>
<p>Example:</p><div class="fragment"><div class="line"><span class="keyword">class </span>C: <span class="keyword">public</span> CRefClass {</div><div class="line">   A *member;</div><div class="line"></div><div class="line">   C(A *a) {</div><div class="line">       member = a;</div><div class="line">       member-&gt;Retain();       <span class="comment">// Take ownership</span></div><div class="line">   }</div><div class="line">   ~C() {</div><div class="line">       member-&gt;Release();</div><div class="line">   }</div><div class="line">   A *getMember() {</div><div class="line">       <span class="keywordflow">return</span> member;          <span class="comment">// Getter so no need to make the caller owner</span></div><div class="line">   }</div><div class="line">   <span class="keywordtype">void</span> setMember(A *newMember) {</div><div class="line">       member-&gt;Release();      <span class="comment">// Release the original member</span></div><div class="line">       member = newMember;     <span class="comment">// Assign the new one</span></div><div class="line">       member-&gt;Retain();       <span class="comment">// And take ownership on the new one</span></div><div class="line">   }</div><div class="line">};</div><div class="line"></div><div class="line">C *c = <span class="keyword">new</span> C(...);</div><div class="line">A *a = c.getMember();</div><div class="line">c-&gt;Release();          <span class="comment">// Release what we created, not &#39;a&#39; which we don&#39;t own </span></div></div><!-- fragment --><p>Note: you may also create <a class="el" href="struct_cot_c_helpers_1_1_c_ref_class.html">CRefClass</a>'es on the stack. In that case, the original creator shall not call Release() (other objects which have called Retain() may though, as they don't know how the variable was created). The following will work as expected:</p><div class="fragment"><div class="line"><span class="keywordtype">void</span> func(C *pointer) {</div><div class="line">   <span class="comment">// This function is unaware of how the object was created so it can Retain/Release it...</span></div><div class="line">   pointer-&gt;Retain();</div><div class="line">   ...</div><div class="line">   pointer-&gt;Release();</div><div class="line">}</div><div class="line">C var;</div><div class="line">func(&amp;var);</div><div class="line"><span class="comment">// No need to call var.Release() as it was created on the stack </span></div></div><!-- fragment --><p>An exception saying "Freeing an object that is still retained elsewhere" can be triggered if you delete an object without using Release(). This can also happen implicitly when using the stack, as in the following example:</p><div class="fragment"><div class="line"><span class="keyword">struct </span>A: <span class="keyword">public</span> CRefClass { ... };</div><div class="line"><span class="keyword">struct </span>B {</div><div class="line">   A *member;</div><div class="line">   ~B() { member-&gt;Release(); }</div><div class="line">   <span class="keywordtype">void</span> setMember(A *newMember) {</div><div class="line">       member = newMember, member-&gt;Retain();</div><div class="line">   }</div><div class="line">   <span class="keywordtype">void</span> useMember() {</div><div class="line">       member-&gt;doMethod();</div><div class="line">   }</div><div class="line">};</div><div class="line">B b;</div><div class="line">{</div><div class="line">   A a;</div><div class="line">   b.setMember(&amp;a);</div><div class="line">}</div><div class="line">b.useMember();         <span class="comment">// exception </span></div></div><!-- fragment --><p>In this example, the object A is destroyed by the compiler as we reach the end of the block, but it is still retained in B. This is why it is highly recommended not to create <a class="el" href="struct_cot_c_helpers_1_1_c_ref_class.html">CRefClass</a>'es on the stack except for local use. </p>
</div><hr/>The documentation for this struct was generated from the following file:<ul>
<li>Headers/<a class="el" href="_cot_c_helpers_8h_source.html">CotCHelpers.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 7 2019 16:30:55 for CloudBuilder C++ SDK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
