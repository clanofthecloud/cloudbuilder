<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CloudBuilder C++ SDK: Working with user related data</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xtralife-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CloudBuilder C++ SDK
   &#160;<span id="projectnumber">v3.0.0</span>
   </div>
   <div id="projectbrief">Making social games is easy !</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Working with user related data </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>When working on your new game, one of the first things you will want to do is saving some information about this user. By using Clan of the Cloud APIs for storing information, it will be available from any of the devices this user will use to log in with his Clan of the Cloud profile. You can ensure this way that your players will enjoy the same experience, and this also acts a backup in case a device is lost. Storing some user's information in the cloud is possible with Clan of the Cloud APIs of course, but you have many different ways to achieve this. We will detail below the possibilities that are available to the developer, and will explain when to use them, since some APIs are better suited depending on what you want to save.</p>
<ul>
<li><b>User Profile</b><br />
 This section of information is unique, global, and very limited. It's something you will not use on a regular basis. The user's profile is shared between all games, from all companies using Clan of the Cloud. Because of this, it only contains data which are really private to the player, like his name, e-mail, address, and other private data that he agreed to provide. Because any game can, at any time, modify all or part of this profile, you should not expect it to store data pertaining to your game(s).<br />
 The authorized fields supported in the profile are the following ones: "email", "displayName", "lang", "firstName", "lastName", "addr1", "addr2", "addr3" and "avatar". Note that all corresponding values have to be strings.<br />
 Let's see some code to help you retrieve and modify a user's profile, provided this user is already logged on with any of the available profiles. Note that when modifying a user profile, it is not mandatory to send all the keys at once. You can send only one key, or a subset, or all of them.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">class </span>MyGame {</div><div class="line">    <span class="keywordtype">void</span> ReadUserProfile() {</div><div class="line">        <a class="code" href="class_cloud_builder_1_1_c_user_manager.html#a48bbd56bf936250788c08eaf9bf45712">CloudBuilder::CUserManager::Instance</a>()-&gt;<a class="code" href="group__user__profile.html#ga513ad47303ade8a61fb3a16b44703c0b">GetProfile</a>(<a class="code" href="namespace_cloud_builder.html#a0b1b22f20ce072961d4674a3fbc20559">CloudBuilder::MakeResultHandler</a>(<span class="keyword">this</span>, &amp;MyGame::ReadUserProfileDone));</div><div class="line">    }</div><div class="line">    <span class="keywordtype">void</span> WriteUserProfile() {</div><div class="line">        <a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html">CloudBuilder::CHJSON</a>* json = <span class="keyword">new</span> <a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html">CloudBuilder::CHJSON</a>;</div><div class="line">        json-&gt;<a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html#a4e82d022dfb462ff570458aa6fc5676d">Put</a>(<span class="stringliteral">&quot;displayName&quot;</span>, <span class="stringliteral">&quot;My user display name&quot;</span>);</div><div class="line">        json-&gt;<a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html#a4e82d022dfb462ff570458aa6fc5676d">Put</a>(<span class="stringliteral">&quot;lang&quot;</span>, <span class="stringliteral">&quot;fr&quot;</span>);</div><div class="line">        <a class="code" href="class_cloud_builder_1_1_c_user_manager.html#a48bbd56bf936250788c08eaf9bf45712">CloudBuilder::CUserManager::Instance</a>()-&gt;<a class="code" href="group__user__profile.html#gae3634331ad8497edc29def94adb39436">SetProfile</a>(json, <a class="code" href="namespace_cloud_builder.html#a0b1b22f20ce072961d4674a3fbc20559">CloudBuilder::MakeResultHandler</a>(<span class="keyword">this</span>, &amp;MyGame::WriteUserProfileDone));</div><div class="line">        <span class="keyword">delete</span> json;</div><div class="line">    }</div><div class="line">    <span class="keywordtype">void</span> ReadUserProfileDone(<a class="code" href="namespace_cloud_builder.html#ab5524f4b2296da386bc5d0ec8e103c27">CloudBuilder::eErrorCode</a> aErrorCode, <span class="keyword">const</span> <a class="code" href="class_cloud_builder_1_1_c_cloud_result.html">CloudBuilder::CCloudResult</a> *aResultGetProfile) {</div><div class="line">        <span class="keywordflow">if</span> (aErrorCode == <a class="code" href="namespace_cloud_builder.html#ab5524f4b2296da386bc5d0ec8e103c27abc8840e9760b529a2d3da0cb0971d491">CloudBuilder::enNoErr</a>)</div><div class="line">            printf(<span class="stringliteral">&quot;The profile display name is %s\n&quot;</span>, aResultGetProfile-&gt;<a class="code" href="class_cloud_builder_1_1_c_cloud_result.html#a0d21cf9d2a8310128a2e13c3eb292ba7">GetJSON</a>()-&gt;<a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html#a13ab5512390ba71a335365c16e6a8dda">GetString</a>(<span class="stringliteral">&quot;displayName&quot;</span>));</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">            printf(<span class="stringliteral">&quot;GetProfile failed with message %s!\n&quot;</span>, aResultGetProfile-&gt;<a class="code" href="class_cloud_builder_1_1_c_cloud_result.html#a9ae079ca8b62d19a1a365ed67ae27ea8">GetErrorString</a>());</div><div class="line">     }</div><div class="line">    <span class="keywordtype">void</span> WriteUserProfileDone(<a class="code" href="namespace_cloud_builder.html#ab5524f4b2296da386bc5d0ec8e103c27">CloudBuilder::eErrorCode</a> aErrorCode, <span class="keyword">const</span> <a class="code" href="class_cloud_builder_1_1_c_cloud_result.html">CloudBuilder::CCloudResult</a> *aResultSetProfile) {</div><div class="line">        <span class="keywordflow">if</span> (aErrorCode == <a class="code" href="namespace_cloud_builder.html#ab5524f4b2296da386bc5d0ec8e103c27abc8840e9760b529a2d3da0cb0971d491">CloudBuilder::enNoErr</a>)</div><div class="line">            printf(<span class="stringliteral">&quot;Profile modified\n&quot;</span>);</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">            printf(<span class="stringliteral">&quot;SetProfile failed with message %s!\n&quot;</span>, aResultSetProfile-&gt;<a class="code" href="class_cloud_builder_1_1_c_cloud_result.html#a9ae079ca8b62d19a1a365ed67ae27ea8">GetErrorString</a>());</div><div class="line">    }</div><div class="line">};</div></div><!-- fragment --><ul>
<li><b>Key/Value</b><br />
</li>
</ul>
<p>The most flexible way to store any kind of information for your users is to use the key/value storing feature provided. Each user has a dedicated set of keys and values, that you are free to manage as you wish. There is no restriction, so you can at any time add, modify or remove any keys. It's entirely up to the developer to manage this storage, and Clan of the Cloud will not interfere with it.<br />
 Note that you have two options for using this feature. If you don't pass a domain when accessing your keys, then everything will be local to your game. However, if you pass a domain previously created from your '<a class="el" href="namespace_cloud_builder.html">CloudBuilder</a> Manager' (<a href="https://account.clanofthecloud.com/#/share">https://account.clanofthecloud.com/#/share</a>), then your whole set of keys and values will be accessible from all applications which share this domain.<br />
 This means first that you theoretically have an unlimited number of sets of keys and values. Then also, be sure when using domains, to make matching Read and Write calls in the same domain, or otherwise you will not be able to read some previously written data in another domain!<br />
 Also, if you ignore the "key" entry in your JSON configuration when writing some information, be aware that you are replacing all the existing keys for this user. This option should be used with great care, and only under precise circumstances, or you may lose all the data for your user! In the same way, but without the dramatic consequences, not passing "key" when reading information, you will be returned the whole set of keys associated to this user.<br />
 In the following samples, the information stored for a given key is a simple string. However, it could be a whole JSON if you need so. If this were the case, you'd have to adapt the read operation for such a key in order to handle the result as a JSON object, and not as a string.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MyGame {</div><div class="line">    <span class="keywordtype">void</span> ReadDataFromKey(<span class="keyword">const</span> <span class="keywordtype">char</span>* aKey) {</div><div class="line">        <a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html">CloudBuilder::CHJSON</a>* json = <span class="keyword">new</span> <a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html">CloudBuilder::CHJSON</a>;</div><div class="line">        <span class="comment">//  Not filling in the &quot;domain&quot; entry implicitly means we want to retrieve from the &quot;private&quot; domain.</span></div><div class="line">        json-&gt;<a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html#a4e82d022dfb462ff570458aa6fc5676d">Put</a>(<span class="stringliteral">&quot;key&quot;</span>, aKey);</div><div class="line">        <a class="code" href="class_cloud_builder_1_1_c_user_manager.html#a48bbd56bf936250788c08eaf9bf45712">CloudBuilder::CUserManager::Instance</a>()-&gt;KeyValueRead(json, <a class="code" href="namespace_cloud_builder.html#a0b1b22f20ce072961d4674a3fbc20559">CloudBuilder::MakeResultHandler</a>(<span class="keyword">this</span>, &amp;MyGame::ReadDataFromKeyDone));</div><div class="line">        <span class="keyword">delete</span> json;</div><div class="line">    }</div><div class="line">    <span class="keywordtype">void</span> WriteDataWithKey(<span class="keyword">const</span> <span class="keywordtype">char</span>* aKey, <span class="keyword">const</span> <span class="keywordtype">char</span>* aValue) {</div><div class="line">        <a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html">CloudBuilder::CHJSON</a>* json = <span class="keyword">new</span> <a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html">CloudBuilder::CHJSON</a>;</div><div class="line">        <span class="comment">//  Not filling in the &quot;domain&quot; entry implicitly means we want to retrieve from the &quot;private&quot; domain.</span></div><div class="line">        json-&gt;<a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html#a4e82d022dfb462ff570458aa6fc5676d">Put</a>(<span class="stringliteral">&quot;key&quot;</span>, aKey);</div><div class="line">        json-&gt;<a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html#a4e82d022dfb462ff570458aa6fc5676d">Put</a>(<span class="stringliteral">&quot;data&quot;</span>, aValue);</div><div class="line">        <a class="code" href="class_cloud_builder_1_1_c_user_manager.html#a48bbd56bf936250788c08eaf9bf45712">CloudBuilder::CUserManager::Instance</a>()-&gt;KeyValueWrite(json, <a class="code" href="namespace_cloud_builder.html#a0b1b22f20ce072961d4674a3fbc20559">CloudBuilder::MakeResultHandler</a>(<span class="keyword">this</span>, &amp;MyGame::WriteDataWithKeyDone));</div><div class="line">        <span class="keyword">delete</span> json;</div><div class="line">    }</div><div class="line">    <span class="keywordtype">void</span> ReadDataFromKeyDone(<a class="code" href="namespace_cloud_builder.html#ab5524f4b2296da386bc5d0ec8e103c27">CloudBuilder::eErrorCode</a> aErrorCode, <span class="keyword">const</span> <a class="code" href="class_cloud_builder_1_1_c_cloud_result.html">CloudBuilder::CCloudResult</a> *aResultReadDataFromKey) {</div><div class="line">        <span class="keywordflow">if</span> (aErrorCode == <a class="code" href="namespace_cloud_builder.html#ab5524f4b2296da386bc5d0ec8e103c27abc8840e9760b529a2d3da0cb0971d491">CloudBuilder::enNoErr</a>)</div><div class="line">            printf(<span class="stringliteral">&quot;Value is %s\n&quot;</span>, aResultReadDataFromKey-&gt;<a class="code" href="class_cloud_builder_1_1_c_cloud_result.html#a0d21cf9d2a8310128a2e13c3eb292ba7">GetJSON</a>()-&gt;<a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html#a13ab5512390ba71a335365c16e6a8dda">GetString</a>(<span class="stringliteral">&quot;value&quot;</span>));</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">            printf(<span class="stringliteral">&quot;Read operation failed with message %s!\n&quot;</span>, aResultReadDataFromKey-&gt;<a class="code" href="class_cloud_builder_1_1_c_cloud_result.html#a9ae079ca8b62d19a1a365ed67ae27ea8">GetErrorString</a>());</div><div class="line">    }</div><div class="line">    <span class="keywordtype">void</span> WriteDataWithKeyDone(<a class="code" href="namespace_cloud_builder.html#ab5524f4b2296da386bc5d0ec8e103c27">CloudBuilder::eErrorCode</a> aErrorCode, <span class="keyword">const</span> <a class="code" href="class_cloud_builder_1_1_c_cloud_result.html">CloudBuilder::CCloudResult</a> *aResultWriteDataWithKey) {</div><div class="line">        <span class="keywordflow">if</span> (aErrorCode == <a class="code" href="namespace_cloud_builder.html#ab5524f4b2296da386bc5d0ec8e103c27abc8840e9760b529a2d3da0cb0971d491">CloudBuilder::enNoErr</a>)</div><div class="line">            printf(<span class="stringliteral">&quot;Write operation succeeded\n&quot;</span>);</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">            printf(<span class="stringliteral">&quot;Write operation failed with message %s!\n&quot;</span>, aResultWriteDataWithKey-&gt;<a class="code" href="class_cloud_builder_1_1_c_cloud_result.html#a9ae079ca8b62d19a1a365ed67ae27ea8">GetErrorString</a>());</div><div class="line">    }</div><div class="line">};</div></div><!-- fragment --><ul>
<li><b>User Properties</b><br />
</li>
</ul>
<p>There is another way to manage player's informations. For generic purposes and complex data, you should use Key/Value as described above. However, if you want to store very simple information like bool, string and number, you can use the User Properties APIs. Specifically, they are mandatory to use when you want to implement match making into your game. It's here that you will store properties which have to be matched against other players' properties so we can return you some possible opponents. But nothing prevents you from using it also for storing other bits of information, if they are trivial, which might never be used for match making (since in match making, it's up to the developer to build the query that will return possible opponents).<br />
 Just like with Key/Value APIs, User Properties belong to a domain. Not filling in the domain entry when working with properties means that you want to access it in the default, private domain of the game. If it is the case, then these properties will not be shared amongst different games.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MyGame {</div><div class="line">    <span class="keywordtype">void</span> GetProperty(<span class="keyword">const</span> <span class="keywordtype">char</span>* aProperty) {</div><div class="line">        <span class="comment">//  Not filling in the &quot;domain&quot; entry implicitly means we want to retrieve from the &quot;private&quot; domain.</span></div><div class="line">        <a class="code" href="class_cloud_builder_1_1_c_user_manager.html#a48bbd56bf936250788c08eaf9bf45712">CloudBuilder::CUserManager::Instance</a>()-&gt;<a class="code" href="group__user__profile.html#ga6ce6ca40ac56f2cd3f8b885877824daa">GetProperty</a>(<a class="code" href="namespace_cloud_builder.html#a0b1b22f20ce072961d4674a3fbc20559">CloudBuilder::MakeResultHandler</a>(<span class="keyword">this</span>, &amp;MyGame::GetPropertyDone), aProperty);</div><div class="line">    }</div><div class="line">    <span class="keywordtype">void</span> SetProperty(<span class="keyword">const</span> <span class="keywordtype">char</span>* aKey, <span class="keyword">const</span> <span class="keywordtype">char</span>* aValue) {</div><div class="line">        <a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html">CloudBuilder::CHJSON</a>* json = <span class="keyword">new</span> <a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html">CloudBuilder::CHJSON</a>;</div><div class="line">        <span class="comment">//  Not passing the domain parameter implicitly means we want to retrieve from the &quot;private&quot; domain.</span></div><div class="line">        json-&gt;<a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html#a4e82d022dfb462ff570458aa6fc5676d">Put</a>(aKey, aValue);</div><div class="line">        <a class="code" href="class_cloud_builder_1_1_c_user_manager.html#a48bbd56bf936250788c08eaf9bf45712">CloudBuilder::CUserManager::Instance</a>()-&gt;<a class="code" href="group__user__profile.html#gab1e3a38c7587c3da91c4d42839d2360b">SetProperty</a>(<a class="code" href="namespace_cloud_builder.html#a0b1b22f20ce072961d4674a3fbc20559">CloudBuilder::MakeResultHandler</a>(<span class="keyword">this</span>, &amp;MyGame::SetPropertyDone), json);</div><div class="line">        <span class="keyword">delete</span> json;</div><div class="line">    }</div><div class="line">    <span class="keywordtype">void</span> GetPropertyDone(<a class="code" href="namespace_cloud_builder.html#ab5524f4b2296da386bc5d0ec8e103c27">CloudBuilder::eErrorCode</a> aErrorCode, <span class="keyword">const</span> <a class="code" href="class_cloud_builder_1_1_c_cloud_result.html">CloudBuilder::CCloudResult</a> *aResultGetProperty)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span> (aErrorCode == <a class="code" href="namespace_cloud_builder.html#ab5524f4b2296da386bc5d0ec8e103c27abc8840e9760b529a2d3da0cb0971d491">CloudBuilder::enNoErr</a>) {</div><div class="line">            CHJSON* <span class="keyword">property</span> = aResultGetProperty-&gt;<a class="code" href="class_cloud_builder_1_1_c_cloud_result.html#a0d21cf9d2a8310128a2e13c3eb292ba7">GetJSON</a>()-&gt;<a class="code" href="class_cot_c_helpers_1_1_c_h_j_s_o_n.html#a2cf5a5c4ceebb917cbf64aa77475536b">Get</a>(<span class="stringliteral">&quot;properties&quot;</span>);</div><div class="line">            printf(<span class="stringliteral">&quot;Property Level is %d\n&quot;</span>, property-&gt;GetString(<span class="stringliteral">&quot;Level&quot;</span>));</div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">            printf(<span class="stringliteral">&quot;Property retrieval failed with message %s!\n&quot;</span>, aResultGetProperty-&gt;<a class="code" href="class_cloud_builder_1_1_c_cloud_result.html#a9ae079ca8b62d19a1a365ed67ae27ea8">GetErrorString</a>());</div><div class="line">    }</div><div class="line">    <span class="keywordtype">void</span> SetPropertyDone(<a class="code" href="namespace_cloud_builder.html#ab5524f4b2296da386bc5d0ec8e103c27">CloudBuilder::eErrorCode</a> aErrorCode, <span class="keyword">const</span> <a class="code" href="class_cloud_builder_1_1_c_cloud_result.html">CloudBuilder::CCloudResult</a> *aResultSetProperty)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span> (aErrorCode == <a class="code" href="namespace_cloud_builder.html#ab5524f4b2296da386bc5d0ec8e103c27abc8840e9760b529a2d3da0cb0971d491">CloudBuilder::enNoErr</a>)</div><div class="line">            printf(<span class="stringliteral">&quot;SetProperty succeeded\n&quot;</span>);</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">            printf(<span class="stringliteral">&quot;SetProperty failed with message %s!\n&quot;</span>, aResultSetProperty-&gt;<a class="code" href="class_cloud_builder_1_1_c_cloud_result.html#a9ae079ca8b62d19a1a365ed67ae27ea8">GetErrorString</a>());</div><div class="line">    }</div><div class="line">};</div></div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Mar 8 2019 13:06:29 for CloudBuilder C++ SDK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
